<!DOCTYPE html>
<html>

<head>
    <title>Front Desk Operator</title>
    <link rel="stylesheet" href="{{ url_for('static',filename='/css/front_desk_op_style.css') }}">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>
</head>

<body>
    <div class="panel">Front Desk Operator</div>
    <div class="container">
        <div class="panel-options">
            <ul>
                <form action="/registerpatientbutton">
                    <li>
                        <button class="option-format">Register Patient</button>
                    </li>
                </form>
                <form action="/admitpatientbutton">
                    <li>
                        <button class="option-format">Admit Patient</button>
                    </li>
                </form>
                <form action="/dischargepatientbutton">
                    <li>
                        <button class="option-format">Discharge Patient</button>
                    </li>
                </form>
                <form action="/makeappointmentbutton">
                    <li>
                        <button class="option-format">Make Doctor Appointment</button>
                    </li>
                </form>
                <form action="/scheduletesttreatmentbutton">
                    <li>
                        <button class="option-format">Make Test/Treatment Appointmen</button>
                    </li>
                </form>
            </ul>
        </div>
        <div class="panel-form">
            {% if display == 1 %}
            <div id="Register Patient" class="form-panel">
                <h2 style="margin-top: 80px;">Register Patient</h2>
                <form action="/registerpatient" method="post">
                    <label for="patient-name">Patient Name:</label>
                    <input type="text" id="patient-name" name="patient-name" required>

                    <label for="patient-age">Age:</label>
                    <input type="number" id="patient-age" name="patient-age" required>

                    <label for="patient-phone">Phone Number:</label>
                    <input type="text" id="patient-phone" name="patient-phone" required>

                    <label for="patient-email">e-Mail ID:</label>
                    <input type="email" id="patient-email" name="patient-email" required>

                    <label for="patient-address">Address:</label>
                    <input type="text" id="patient-address" name="patient-address" required>


                    <label for="patient-ins">Insurance ID:</label>
                    <input type="text" id="patient-ins" name="patient-ins" required>

                    <input type="submit" value="Submit">
                </form>
                {% if flag == 1 %}
                    <h3 style="color: maroon;">Error Registering Patient!</h3>
                {% endif %}
            </div>
            {% endif %} 
            {% if display == 2 %}                
            <div id="Admit Patient" class="form-panel">
                <h2 style="margin-top: 80px;">Admit Patient</h2>
                <h3>(Make sure Patient is Registered first)</h3>
                <form action="/admitpatient" method="post">
                    <label for="patient-id">Patient ID:</label>
                    <input type="text" id="patient-id" name="patient-id" required>

                    <label for="admit-date">Admit Date:</label>
                    <input type="date" id="admit-date" name="admit-date" required>

                    <input type="submit" value="Submit">
                </form>
                {% if flag == 1 %}
                    <h3 style="color: maroon;">Patient Not Found!</h3>
                {% endif %}
            </div>
            {% endif %}
            {% if display == 3 %}
            <div id="Discharge Patient" class="form-panel">
                <h2 style="margin-top: 80px;">Discharge Patient</h2>
                <h3>(Make sure Patient is Registered first)</h3>
                <form action="/dischargepatient" method="post">
                    <label for="patient-id">Patient ID:</label>
                    <input type="text" id="patient-id" name="patient-id" required>

                    <label for="discharge-date">Discharge Date:</label>
                    <input type="date" id="discharge-date" name="discharge-date" required>
                    <input type="submit" value="Submit">
                </form>
                {% if flag == 1 %}
                    <h3 style="color: maroon;">Patient Not Found!</h3>
                {% endif %}
            </div>
            {% endif %}
            {% if display == 4 %}
            <div id="Make Doctor Appointment" class="form-panel">
                <h2 style="margin-top: 80px;">Make Doctor's Appointment</h2>
                <h3>(Make sure Patient is Registered first)</h3>
                <form action="/makeappointment" method="post">
                    <label for="patient-id">Patient ID:</label>
                    <input type="text" id="patient-id" name="patient-id" required>

                    <label for="doc-id">Doctor ID:</label>
                    <input type="text" id="doc-id" name="doc-id" required>
                    <input type="submit" value="Submit">
                </form>
                {% if flag == 1 %}
                    <h3 style="color: maroon;">Patient Not Found!</h3>
                {% endif %}
                {% if flag == 2 %}
                    <h3 style="color: maroon;">Doctor Not Found!</h3>
                {% endif %}
                {% if flag == 3 %}
                    <h3 style="color: greenyellow;">Appointment set to : {{ date }}</h3>
                    <button class="btn-schedule" onclick="scheduleAppointment('{{ curdetails }}', '{{ date }}')">Get PDF</button>
                {% endif %}
                <script>
                    function scheduleAppointment(curdetails, date) {
                        var curdetailArray = curdetails.split(',');
                        var patientID = curdetailArray[0];
                        var patientName = curdetailArray[1];
                        var doctorID = curdetailArray[2];
                        var doctorName = curdetailArray[3];
                        console.log(patientID, patientName, doctorID, doctorName, date);
                        generatePdfA(patientID, patientName, doctorID, doctorName, date);
                    }

                    function generatePdfA(patientID, patientName, doctorID, doctorName, date) {
                        var newdoc = new jsPDF();
                        newdoc.text("Patient ID: " + patientID, 20, 20);
                        newdoc.text("Patient Name: " + patientName, 20, 30);
                        newdoc.text("Doctor ID: " + doctorID, 20, 40);
                        newdoc.text("Doctor Name: " + doctorName, 20, 50);
                        newdoc.text("Date: " + date, 20, 60);
                        newdoc.save(patientName+" Appointment.pdf");
                    }
                </script>
            </div>
            {% endif %}
            {% if display == 5 %}
            <div id="Make TnT Appointment" class="form-panel">
                <h2 style="margin-top: 80px;">Make Test/Treatment Appointment</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Patient Name</th>
                            <th>Treatment/Test</th>
                            <th>Doctor</th>
                            <th>Action</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for test in tests %}
                        <tr>
                            <td>{{ test[1] }}</td>
                            <td>{{ test[3] }}</td>
                            <td>{{ test[5] }}</td>
                            <td>
                                <form action="/scheduletesttreatment" method="post">
                                    <input type="hidden" name="patient-id" value="{{ test[0] }}">
                                    <input type="hidden" name="patient-name" value="{{ test[1] }}">
                                    <input type="hidden" name="test-id" value="{{ test[2] }}">
                                    <input type="hidden" name="test-treatment" value="{{ test[3] }}">
                                    <input type="hidden" name="doctor-id" value="{{ test[4] }}">
                                    <input type="hidden" name="doctor-name" value="{{ test[5] }}">
                                    <button class="btn-schedule">Schedule</button>
                                </form>
                            </td>
                            <td class="not-scheduled">Not yet Scheduled</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>

                {% if flag == 1 %}
                    <button class="btn-schedule" onclick="scheduletesttreatment('{{ curtest }}', '{{ date }}')">Get PDF</button>
                {% endif %}

                <script>
                    function scheduletesttreatment(curtest, date) {
                        var curtestArray = curtest.split(',');
                        var patientName = curtestArray[0];
                        var testtreatment = curtestArray[1];
                        var doctor = curtestArray[2];
                        generatePdfTT(patientName, testtreatment, doctor, date);
                    }

                    function generatePdfTT(patientName, testtreatment, doctor, date) {
                        var doc = new jsPDF();
                        doc.text("Patient Name: " + patientName, 20, 20);
                        doc.text("Test/Treatment: " + testtreatment, 20, 30);
                        doc.text("Doctor: " + doctor, 20, 40);
                        doc.text("Date: " + date, 20, 50);
                        doc.save(patientName+" Schedule.pdf");
                    }
                </script>
            </div>
            {% endif %}
        </div>
    </div>
</body>
</html>